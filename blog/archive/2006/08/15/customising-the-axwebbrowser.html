<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">

    <title>Customising the AxWebBrowser - timjones.io</title>

    <meta name="description" content="Blog and open source projects by Tim Jones.">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="alternate" href="http://timjones.io/feed.xml" type="application/atom+xml" title="timjones.io Feed">

    <link href="https://fonts.googleapis.com/css?family=Noto+Sans|Noto+Serif|Source+Code+Pro" rel="stylesheet">
    <link rel="stylesheet" href="/assets/css/site.css">

    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [['$','$'], ['\\(','\\)']],
                processEscapes: true
            },
            showProcessingMessages: false
        });
    </script>
    <script type="text/javascript" async src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML.js"></script>
</head>

<body>
    <header class="masthead">
        <div class="container">
            <nav>
                <ul>
                    <li>
                        <h3><a href="/" class="site-title">Tim Jones</a></h3>
                    </li>
                    <li><a href="/projects/">Projects</a></li>
                    <li><a href="/about/">About</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <div class="container">
        <main>
            <article>
    <h1 class="post-title">Customising the AxWebBrowser</h1>

    <div class="post-date">
        <time datetime="2006-08-15T15:22:00+00:00">15 August 2006</time>
    </div>

    

    <p>I recently needed to use AxWebBrowser component to do some automation of web page form filling. I wanted to capture Javascript alert boxes, grab the text from the alert box, and return it as an error to the user of my application.</p>

<p>I also wanted to disable the loading of images and Flash animations. The code for this is below, in the <code class="highlighter-rouge">IDispatch_Invoke_Handler</code> method.</p>

<p>It took me a long time to track down the method of doing this, so I thought I’d put it here in case anybody else needs the same info.</p>

<p>First, some links I found useful:</p>

<ul>
  <li><a href="http://starkravingfinkle.org/blog/2004/09/">Mark Finkle’s blog</a></li>
  <li><a href="http://www.codeproject.com/csharp/ExtendedWebBrowser.asp">Extended WebBrowser Control</a></li>
  <li><a href="http://support.microsoft.com/?kbid=279535">How to suppress run-time script errors as a WebBrowser control host</a></li>
  <li><a href="http://support.microsoft.com/kb/261003/">How to handle script errors as a WebBrowser control host</a></li>
  <li><a href="http://msdn.microsoft.com/workshop/browser/mshtml/overview/overview.asp">About MSHTML</a></li>
</ul>

<p>The following code shows how to setup the web browser such that you are alerted when Javascript popups are shown.</p>

<p>First, you need to define some constants and interfaces.</p>

<div class="language-csharp highlighter-rouge"><pre class="highlight"><code><span class="k">public</span> <span class="k">enum</span> <span class="n">ComConstants</span> <span class="p">:</span> <span class="kt">uint</span>
<span class="p">{</span>
 <span class="n">DLCTL_DLIMAGES</span>                          <span class="p">=</span> <span class="m">0x00000010</span><span class="p">,</span>
 <span class="n">DLCTL_VIDEOS</span>                            <span class="p">=</span> <span class="m">0x00000020</span><span class="p">,</span>
 <span class="n">DLCTL_BGSOUNDS</span>                          <span class="p">=</span> <span class="m">0x00000040</span><span class="p">,</span>
 <span class="n">DLCTL_NO_SCRIPTS</span>                        <span class="p">=</span> <span class="m">0x00000080</span><span class="p">,</span>
 <span class="n">DLCTL_NO_JAVA</span>                           <span class="p">=</span> <span class="m">0x00000100</span><span class="p">,</span>
 <span class="n">DLCTL_NO_RUNACTIVEXCTLS</span>                 <span class="p">=</span> <span class="m">0x00000200</span><span class="p">,</span>
 <span class="n">DLCTL_NO_DLACTIVEXCTLS</span>                  <span class="p">=</span> <span class="m">0x00000400</span><span class="p">,</span>
 <span class="n">DLCTL_DOWNLOADONLY</span>                      <span class="p">=</span> <span class="m">0x00000800</span><span class="p">,</span>
 <span class="n">DLCTL_NO_FRAMEDOWNLOAD</span>                  <span class="p">=</span> <span class="m">0x00001000</span><span class="p">,</span>
 <span class="n">DLCTL_RESYNCHRONIZE</span>                     <span class="p">=</span> <span class="m">0x00002000</span><span class="p">,</span>
 <span class="n">DLCTL_PRAGMA_NO_CACHE</span>                   <span class="p">=</span> <span class="m">0x00004000</span><span class="p">,</span>
 <span class="n">DLCTL_NO_BEHAVIORS</span>                      <span class="p">=</span> <span class="m">0x00008000</span><span class="p">,</span>
 <span class="n">DLCTL_NO_METACHARSET</span>                    <span class="p">=</span> <span class="m">0x00010000</span><span class="p">,</span>
 <span class="n">DLCTL_URL_ENCODING_DISABLE_UTF8</span>         <span class="p">=</span> <span class="m">0x00020000</span><span class="p">,</span>
 <span class="n">DLCTL_URL_ENCODING_ENABLE_UTF8</span>          <span class="p">=</span> <span class="m">0x00040000</span><span class="p">,</span>
 <span class="n">DLCTL_NOFRAMES</span>                          <span class="p">=</span> <span class="m">0x00080000</span><span class="p">,</span>
 <span class="n">DLCTL_FORCEOFFLINE</span>                      <span class="p">=</span> <span class="m">0x10000000</span><span class="p">,</span>
 <span class="n">DLCTL_NO_CLIENTPULL</span>                     <span class="p">=</span> <span class="m">0x20000000</span><span class="p">,</span>
 <span class="n">DLCTL_SILENT</span>                            <span class="p">=</span> <span class="m">0x40000000</span><span class="p">,</span>
 <span class="n">DLCTL_OFFLINEIFNOTCONNECTED</span>             <span class="p">=</span> <span class="m">0x80000000</span><span class="p">,</span>
 <span class="n">DLCTL_OFFLINE</span>                           <span class="p">=</span> <span class="m">0x80000000</span>
<span class="p">}</span>
</code></pre>
</div>

<div class="language-csharp highlighter-rouge"><pre class="highlight"><code><span class="k">public</span> <span class="k">enum</span> <span class="n">DialogBoxCommandId</span>
<span class="p">{</span>
 <span class="n">Ok</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span>
 <span class="n">Cancel</span> <span class="p">=</span> <span class="m">2</span><span class="p">,</span>
 <span class="n">Abort</span> <span class="p">=</span> <span class="m">3</span><span class="p">,</span>
 <span class="n">Retry</span> <span class="p">=</span> <span class="m">4</span><span class="p">,</span>
 <span class="n">Ignore</span> <span class="p">=</span> <span class="m">5</span><span class="p">,</span>
 <span class="n">Yes</span> <span class="p">=</span> <span class="m">6</span><span class="p">,</span>
 <span class="n">No</span> <span class="p">=</span> <span class="m">7</span><span class="p">,</span>
 <span class="n">TryAgain</span> <span class="p">=</span> <span class="m">10</span><span class="p">,</span>
 <span class="n">Continue</span> <span class="p">=</span> <span class="m">11</span>
<span class="p">}</span>
</code></pre>
</div>

<div class="language-csharp highlighter-rouge"><pre class="highlight"><code><span class="k">using</span> <span class="nn">System.Runtime.InteropServices</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">mshtml</span><span class="p">;</span>

<span class="p">[</span><span class="n">ComImport</span><span class="p">,</span>
<span class="nf">Guid</span><span class="p">(</span><span class="s">"C4D244B0-D43E-11CF-893B-00AA00BDCE1A"</span><span class="p">),</span>
<span class="nf">InterfaceType</span><span class="p">(</span><span class="n">ComInterfaceType</span><span class="p">.</span><span class="n">InterfaceIsIUnknown</span><span class="p">)]</span>
<span class="k">public</span> <span class="k">interface</span> <span class="n">IDocHostShowUI</span>
<span class="p">{</span>
 <span class="p">[</span><span class="n">PreserveSig</span><span class="p">]</span>
 <span class="kt">uint</span> <span class="nf">ShowMessage</span><span class="p">(</span><span class="n">IntPtr</span> <span class="n">hwnd</span><span class="p">,</span> 
  <span class="p">[</span><span class="nf">MarshalAs</span><span class="p">(</span><span class="n">UnmanagedType</span><span class="p">.</span><span class="n">LPWStr</span><span class="p">)]</span> <span class="kt">string</span> <span class="n">lpstrText</span><span class="p">,</span> 
  <span class="p">[</span><span class="nf">MarshalAs</span><span class="p">(</span><span class="n">UnmanagedType</span><span class="p">.</span><span class="n">LPWStr</span><span class="p">)]</span> <span class="kt">string</span> <span class="n">lpstrCaption</span><span class="p">,</span> 
  <span class="kt">uint</span> <span class="n">dwType</span><span class="p">,</span> 
  <span class="p">[</span><span class="nf">MarshalAs</span><span class="p">(</span><span class="n">UnmanagedType</span><span class="p">.</span><span class="n">LPWStr</span><span class="p">)]</span> <span class="kt">string</span> <span class="n">lpstrHelpFile</span><span class="p">,</span> 
  <span class="kt">uint</span> <span class="n">dwHelpContext</span><span class="p">,</span>
  <span class="k">out</span> <span class="kt">int</span> <span class="n">lpResult</span><span class="p">);</span>
                                  
 <span class="p">[</span><span class="n">PreserveSig</span><span class="p">]</span>
 <span class="kt">uint</span> <span class="nf">ShowHelp</span><span class="p">(</span><span class="n">IntPtr</span> <span class="n">hwnd</span><span class="p">,</span> <span class="p">[</span><span class="nf">MarshalAs</span><span class="p">(</span><span class="n">UnmanagedType</span><span class="p">.</span><span class="n">LPWStr</span><span class="p">)]</span> <span class="kt">string</span> <span class="n">pszHelpFile</span><span class="p">,</span> 
  <span class="kt">uint</span> <span class="n">uCommand</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">dwData</span><span class="p">,</span> 
  <span class="n">tagPOINT</span> <span class="n">ptMouse</span><span class="p">,</span> 
  <span class="p">[</span><span class="nf">MarshalAs</span><span class="p">(</span><span class="n">UnmanagedType</span><span class="p">.</span><span class="n">IDispatch</span><span class="p">)]</span> <span class="kt">object</span> <span class="n">pDispatchObjectHit</span><span class="p">);</span>                       
<span class="p">}</span>
</code></pre>
</div>

<div class="language-csharp highlighter-rouge"><pre class="highlight"><code><span class="k">using</span> <span class="nn">System.Runtime.InteropServices</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Windows.Forms</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">mshtml</span><span class="p">;</span>

<span class="k">public</span> <span class="k">enum</span> <span class="n">DOCHOSTUITYPE</span>
<span class="p">{</span>
 <span class="n">DOCHOSTUITYPE_BROWSE</span> <span class="p">=</span> <span class="m">0</span><span class="p">,</span>
 <span class="n">DOCHOSTUITYPE_AUTHOR</span> <span class="p">=</span> <span class="m">1</span>
<span class="p">}</span>

<span class="k">public</span> <span class="k">enum</span> <span class="n">DOCHOSTUIDBLCLK</span>
<span class="p">{</span>
 <span class="n">DOCHOSTUIDBLCLK_DEFAULT</span> <span class="p">=</span> <span class="m">0</span><span class="p">,</span>
 <span class="n">DOCHOSTUIDBLCLK_SHOWPROPERTIES</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span>
 <span class="n">DOCHOSTUIDBLCLK_SHOWCODE</span> <span class="p">=</span> <span class="m">2</span>
<span class="p">}</span>

<span class="k">public</span> <span class="k">enum</span> <span class="n">DOCHOSTUIFLAG</span>
<span class="p">{</span>
 <span class="n">DOCHOSTUIFLAG_DIALOG</span> <span class="p">=</span> <span class="m">0x00000001</span><span class="p">,</span>
 <span class="n">DOCHOSTUIFLAG_DISABLE_HELP_MENU</span> <span class="p">=</span> <span class="m">0x00000002</span><span class="p">,</span>
 <span class="n">DOCHOSTUIFLAG_NO3DBORDER</span> <span class="p">=</span> <span class="m">0x00000004</span><span class="p">,</span>
 <span class="n">DOCHOSTUIFLAG_SCROLL_NO</span> <span class="p">=</span> <span class="m">0x00000008</span><span class="p">,</span>
 <span class="n">DOCHOSTUIFLAG_DISABLE_SCRIPT_INACTIVE</span> <span class="p">=</span> <span class="m">0x00000010</span><span class="p">,</span>
 <span class="n">DOCHOSTUIFLAG_OPENNEWWIN</span> <span class="p">=</span> <span class="m">0x00000020</span><span class="p">,</span>
 <span class="n">DOCHOSTUIFLAG_DISABLE_OFFSCREEN</span> <span class="p">=</span> <span class="m">0x00000040</span><span class="p">,</span>
 <span class="n">DOCHOSTUIFLAG_FLAT_SCROLLBAR</span> <span class="p">=</span> <span class="m">0x00000080</span><span class="p">,</span>
 <span class="n">DOCHOSTUIFLAG_DIV_BLOCKDEFAULT</span> <span class="p">=</span> <span class="m">0x00000100</span><span class="p">,</span>
 <span class="n">DOCHOSTUIFLAG_ACTIVATE_CLIENTHIT_ONLY</span> <span class="p">=</span> <span class="m">0x00000200</span><span class="p">,</span>
 <span class="n">DOCHOSTUIFLAG_OVERRIDEBEHAVIORFACTORY</span> <span class="p">=</span> <span class="m">0x00000400</span><span class="p">,</span>
 <span class="n">DOCHOSTUIFLAG_CODEPAGELINKEDFONTS</span> <span class="p">=</span> <span class="m">0x00000800</span><span class="p">,</span>
 <span class="n">DOCHOSTUIFLAG_URL_ENCODING_DISABLE_UTF8</span> <span class="p">=</span> <span class="m">0x00001000</span><span class="p">,</span>
 <span class="n">DOCHOSTUIFLAG_URL_ENCODING_ENABLE_UTF8</span> <span class="p">=</span> <span class="m">0x00002000</span><span class="p">,</span>
 <span class="n">DOCHOSTUIFLAG_ENABLE_FORMS_AUTOCOMPLETE</span> <span class="p">=</span> <span class="m">0x00004000</span><span class="p">,</span>
 <span class="n">DOCHOSTUIFLAG_ENABLE_INPLACE_NAVIGATION</span> <span class="p">=</span> <span class="m">0x00010000</span><span class="p">,</span>
 <span class="n">DOCHOSTUIFLAG_IME_ENABLE_RECONVERSION</span> <span class="p">=</span> <span class="m">0x00020000</span><span class="p">,</span>
 <span class="n">DOCHOSTUIFLAG_THEME</span> <span class="p">=</span> <span class="m">0x00040000</span><span class="p">,</span>
 <span class="n">DOCHOSTUIFLAG_NOTHEME</span> <span class="p">=</span> <span class="m">0x00080000</span><span class="p">,</span>
 <span class="n">DOCHOSTUIFLAG_NOPICS</span> <span class="p">=</span> <span class="m">0x00100000</span><span class="p">,</span>
 <span class="n">DOCHOSTUIFLAG_NO3DOUTERBORDER</span> <span class="p">=</span> <span class="m">0x00200000</span><span class="p">,</span>
 <span class="n">DOCHOSTUIFLAG_DELEGATESIDOFDISPATCH</span> <span class="p">=</span> <span class="m">0x00400000</span>
<span class="p">}</span>

<span class="na">[StructLayout(LayoutKind.Sequential)]</span>
<span class="k">public</span> <span class="k">struct</span> <span class="nc">DOCHOSTUIINFO</span>
<span class="p">{</span>
 <span class="k">public</span> <span class="kt">uint</span> <span class="n">cbSize</span><span class="p">;</span>
 <span class="k">public</span> <span class="kt">uint</span> <span class="n">dwFlags</span><span class="p">;</span>
 <span class="k">public</span> <span class="kt">uint</span> <span class="n">dwDoubleClick</span><span class="p">;</span>
 <span class="p">[</span><span class="nf">MarshalAs</span><span class="p">(</span><span class="n">UnmanagedType</span><span class="p">.</span><span class="n">BStr</span><span class="p">)]</span> <span class="k">public</span> <span class="kt">string</span> <span class="n">pchHostCss</span><span class="p">;</span>
 <span class="p">[</span><span class="nf">MarshalAs</span><span class="p">(</span><span class="n">UnmanagedType</span><span class="p">.</span><span class="n">BStr</span><span class="p">)]</span> <span class="k">public</span> <span class="kt">string</span> <span class="n">pchHostNS</span><span class="p">;</span>
<span class="p">}</span>

<span class="na">[StructLayout(LayoutKind.Sequential)]</span>
<span class="k">public</span> <span class="k">struct</span> <span class="nc">tagMSG</span>
<span class="p">{</span>
 <span class="k">public</span> <span class="n">IntPtr</span> <span class="n">hwnd</span><span class="p">;</span>
 <span class="k">public</span> <span class="kt">uint</span> <span class="n">message</span><span class="p">;</span>
 <span class="k">public</span> <span class="kt">uint</span> <span class="n">wParam</span><span class="p">;</span>
 <span class="k">public</span> <span class="kt">int</span> <span class="n">lParam</span><span class="p">;</span>
 <span class="k">public</span> <span class="kt">uint</span> <span class="n">time</span><span class="p">;</span>
 <span class="k">public</span> <span class="n">tagPOINT</span> <span class="n">pt</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">[</span><span class="nf">ComImport</span><span class="p">(),</span>
<span class="nf">InterfaceType</span><span class="p">(</span><span class="n">ComInterfaceType</span><span class="p">.</span><span class="n">InterfaceIsIUnknown</span><span class="p">),</span>
<span class="nf">GuidAttribute</span><span class="p">(</span><span class="s">"bd3f23c0-d43e-11cf-893b-00aa00bdce1a"</span><span class="p">)]</span>
<span class="k">public</span> <span class="k">interface</span> <span class="n">IDocHostUIHandler</span>
<span class="p">{</span>
 <span class="p">[</span><span class="n">PreserveSig</span><span class="p">]</span>
 <span class="kt">uint</span> <span class="nf">ShowContextMenu</span><span class="p">(</span><span class="kt">uint</span> <span class="n">dwID</span><span class="p">,</span> <span class="k">ref</span> <span class="n">tagPOINT</span> <span class="n">ppt</span><span class="p">,</span>
  <span class="p">[</span><span class="nf">MarshalAs</span><span class="p">(</span><span class="n">UnmanagedType</span><span class="p">.</span><span class="n">IUnknown</span><span class="p">)]</span>  <span class="kt">object</span> <span class="n">pcmdtReserved</span><span class="p">,</span>
  <span class="p">[</span><span class="nf">MarshalAs</span><span class="p">(</span><span class="n">UnmanagedType</span><span class="p">.</span><span class="n">IDispatch</span><span class="p">)]</span> <span class="kt">object</span> <span class="n">pdispReserved</span><span class="p">);</span>

 <span class="k">void</span> <span class="nf">GetHostInfo</span><span class="p">(</span><span class="k">ref</span> <span class="n">DOCHOSTUIINFO</span> <span class="n">pInfo</span><span class="p">);</span>
 <span class="k">void</span> <span class="nf">ShowUI</span><span class="p">(</span><span class="kt">uint</span> <span class="n">dwID</span><span class="p">,</span> <span class="k">ref</span> <span class="kt">object</span> <span class="n">pActiveObject</span><span class="p">,</span> <span class="k">ref</span> <span class="kt">object</span> <span class="n">pCommandTarget</span><span class="p">,</span> <span class="k">ref</span> <span class="kt">object</span> <span class="n">pFrame</span><span class="p">,</span> <span class="k">ref</span> <span class="kt">object</span> <span class="n">pDoc</span><span class="p">);</span>
 <span class="k">void</span> <span class="nf">HideUI</span><span class="p">();</span>
 <span class="k">void</span> <span class="nf">UpdateUI</span><span class="p">();</span>
 <span class="k">void</span> <span class="nf">EnableModeless</span><span class="p">(</span><span class="kt">int</span> <span class="n">fEnable</span><span class="p">);</span>
 <span class="k">void</span> <span class="nf">OnDocWindowActivate</span><span class="p">(</span><span class="kt">int</span> <span class="n">fActivate</span><span class="p">);</span>
 <span class="k">void</span> <span class="nf">OnFrameWindowActivate</span><span class="p">(</span><span class="kt">int</span> <span class="n">fActivate</span><span class="p">);</span>
 <span class="k">void</span> <span class="nf">ResizeBorder</span><span class="p">(</span><span class="k">ref</span> <span class="n">tagRECT</span> <span class="n">prcBorder</span><span class="p">,</span> <span class="kt">int</span> <span class="n">pUIWindow</span><span class="p">,</span> <span class="kt">int</span> <span class="n">fRameWindow</span><span class="p">);</span>

 <span class="p">[</span><span class="n">PreserveSig</span><span class="p">]</span>
 <span class="kt">uint</span> <span class="nf">TranslateAccelerator</span><span class="p">(</span><span class="k">ref</span> <span class="n">tagMSG</span> <span class="n">lpMsg</span><span class="p">,</span> <span class="k">ref</span> <span class="n">Guid</span> <span class="n">pguidCmdGroup</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">nCmdID</span><span class="p">);</span>

 <span class="k">void</span> <span class="nf">GetOptionKeyPath</span><span class="p">([</span><span class="nf">MarshalAs</span><span class="p">(</span><span class="n">UnmanagedType</span><span class="p">.</span><span class="n">BStr</span><span class="p">)]</span> <span class="k">ref</span> <span class="kt">string</span> <span class="n">pchKey</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">dw</span><span class="p">);</span>
 <span class="kt">object</span> <span class="nf">GetDropTarget</span><span class="p">(</span><span class="k">ref</span> <span class="kt">object</span> <span class="n">pDropTarget</span><span class="p">);</span>
 <span class="kt">object</span> <span class="nf">GetExternal</span><span class="p">();</span>

 <span class="p">[</span><span class="n">PreserveSig</span><span class="p">]</span>
 <span class="kt">uint</span> <span class="nf">TranslateUrl</span><span class="p">(</span><span class="kt">uint</span> <span class="n">dwTranslate</span><span class="p">,</span> 
  <span class="p">[</span><span class="nf">MarshalAs</span><span class="p">(</span><span class="n">UnmanagedType</span><span class="p">.</span><span class="n">BStr</span><span class="p">)]</span> <span class="kt">string</span> <span class="n">pchURLIn</span><span class="p">,</span>
  <span class="p">[</span><span class="nf">MarshalAs</span><span class="p">(</span><span class="n">UnmanagedType</span><span class="p">.</span><span class="n">BStr</span><span class="p">)]</span> <span class="k">ref</span> <span class="kt">string</span> <span class="n">ppchURLOut</span><span class="p">);</span>

 <span class="n">IDataObject</span> <span class="nf">FilterDataObject</span><span class="p">(</span><span class="n">IDataObject</span> <span class="n">pDO</span><span class="p">);</span>
<span class="p">}</span>

<span class="p">[</span><span class="nf">ComImport</span><span class="p">(),</span>
<span class="nf">GuidAttribute</span><span class="p">(</span><span class="s">"3050f6d0-98b5-11cf-bb82-00aa00bdce0b"</span><span class="p">)]</span>
<span class="k">public</span> <span class="k">interface</span> <span class="n">IDocHostUIHandler2</span><span class="p">:</span> <span class="n">IDocHostUIHandler</span>
<span class="p">{</span>
 <span class="k">void</span> <span class="nf">GetOverrideKeyPath</span><span class="p">([</span><span class="nf">MarshalAs</span><span class="p">(</span><span class="n">UnmanagedType</span><span class="p">.</span><span class="n">BStr</span><span class="p">)]</span> <span class="k">ref</span> <span class="kt">string</span> <span class="n">pchKey</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">dw</span><span class="p">);</span>
<span class="p">}</span>
</code></pre>
</div>

<div class="language-csharp highlighter-rouge"><pre class="highlight"><code><span class="k">using</span> <span class="nn">System.Runtime.InteropServices</span><span class="p">;</span>

<span class="p">[</span><span class="n">ComImport</span><span class="p">,</span>
<span class="nf">Guid</span><span class="p">(</span><span class="s">"00000118-0000-0000-C000-000000000046"</span><span class="p">),</span>
<span class="nf">InterfaceType</span><span class="p">(</span><span class="n">ComInterfaceType</span><span class="p">.</span><span class="n">InterfaceIsIUnknown</span><span class="p">)]</span>
<span class="k">public</span> <span class="k">interface</span> <span class="n">IOleClientSite</span>
<span class="p">{</span>
 <span class="k">void</span> <span class="nf">SaveObject</span><span class="p">();</span>
 <span class="k">void</span> <span class="nf">GetMoniker</span><span class="p">(</span><span class="kt">uint</span> <span class="n">dwAssign</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">dwWhichMoniker</span><span class="p">,</span> <span class="k">ref</span> <span class="kt">object</span> <span class="n">ppmk</span><span class="p">);</span>
 <span class="k">void</span> <span class="nf">GetContainer</span><span class="p">(</span><span class="k">ref</span> <span class="kt">object</span> <span class="n">ppContainer</span><span class="p">);</span>
 <span class="k">void</span> <span class="nf">ShowObject</span><span class="p">();</span>
 <span class="k">void</span> <span class="nf">OnShowWindow</span><span class="p">(</span><span class="kt">bool</span> <span class="n">fShow</span><span class="p">);</span>
 <span class="k">void</span> <span class="nf">RequestNewObjectLayout</span><span class="p">();</span>
<span class="p">}</span>
</code></pre>
</div>

<div class="language-csharp highlighter-rouge"><pre class="highlight"><code><span class="k">using</span> <span class="nn">System.Runtime.InteropServices</span><span class="p">;</span>

<span class="p">[</span><span class="n">ComImport</span><span class="p">,</span>
<span class="nf">Guid</span><span class="p">(</span><span class="s">"b722bcc7-4e68-101b-a2bc-00aa00404770"</span><span class="p">),</span>
<span class="nf">InterfaceType</span><span class="p">(</span><span class="n">ComInterfaceType</span><span class="p">.</span><span class="n">InterfaceIsIUnknown</span><span class="p">)]</span>
<span class="k">public</span> <span class="k">interface</span> <span class="n">IOleDocumentSite</span>
<span class="p">{</span>
 <span class="k">void</span> <span class="nf">ActivateMe</span><span class="p">(</span><span class="k">ref</span> <span class="kt">object</span> <span class="n">pViewToActivate</span><span class="p">);</span>
<span class="p">}</span>
</code></pre>
</div>

<div class="language-csharp highlighter-rouge"><pre class="highlight"><code><span class="k">using</span> <span class="nn">System.Runtime.InteropServices</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Windows.Forms</span><span class="p">;</span>

<span class="p">[</span><span class="n">ComImport</span><span class="p">,</span>
<span class="nf">Guid</span><span class="p">(</span><span class="s">"00000112-0000-0000-C000-000000000046"</span><span class="p">),</span>
<span class="nf">InterfaceType</span><span class="p">(</span><span class="n">ComInterfaceType</span><span class="p">.</span><span class="n">InterfaceIsIUnknown</span><span class="p">)]</span>
<span class="k">public</span> <span class="k">interface</span> <span class="n">IOleObject</span>
<span class="p">{</span>
 <span class="k">void</span> <span class="nf">SetClientSite</span><span class="p">(</span><span class="n">IOleClientSite</span> <span class="n">pClientSite</span><span class="p">);</span>
 <span class="k">void</span> <span class="nf">GetClientSite</span><span class="p">(</span><span class="k">ref</span> <span class="n">IOleClientSite</span> <span class="n">ppClientSite</span><span class="p">);</span>
 <span class="k">void</span> <span class="nf">SetHostNames</span><span class="p">(</span><span class="kt">object</span> <span class="n">szContainerApp</span><span class="p">,</span> <span class="kt">object</span> <span class="n">szContainerObj</span><span class="p">);</span>
 <span class="k">void</span> <span class="nf">Close</span><span class="p">(</span><span class="kt">uint</span> <span class="n">dwSaveOption</span><span class="p">);</span>
 <span class="k">void</span> <span class="nf">SetMoniker</span><span class="p">(</span><span class="kt">uint</span> <span class="n">dwWhichMoniker</span><span class="p">,</span> <span class="kt">object</span> <span class="n">pmk</span><span class="p">);</span>
 <span class="k">void</span> <span class="nf">GetMoniker</span><span class="p">(</span><span class="kt">uint</span> <span class="n">dwAssign</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">dwWhichMoniker</span><span class="p">,</span> <span class="kt">object</span> <span class="n">ppmk</span><span class="p">);</span>
 <span class="k">void</span> <span class="nf">InitFromData</span><span class="p">(</span><span class="n">IDataObject</span> <span class="n">pDataObject</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">fCreation</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">dwReserved</span><span class="p">);</span>
 <span class="k">void</span> <span class="nf">GetClipboardData</span><span class="p">(</span><span class="kt">uint</span> <span class="n">dwReserved</span><span class="p">,</span> <span class="k">ref</span> <span class="n">IDataObject</span> <span class="n">ppDataObject</span><span class="p">);</span>
 <span class="k">void</span> <span class="nf">DoVerb</span><span class="p">(</span><span class="kt">uint</span> <span class="n">iVerb</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">lpmsg</span><span class="p">,</span> <span class="kt">object</span> <span class="n">pActiveSite</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">lindex</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">hwndParent</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">lprcPosRect</span><span class="p">);</span>
 <span class="k">void</span> <span class="nf">EnumVerbs</span><span class="p">(</span><span class="k">ref</span> <span class="kt">object</span> <span class="n">ppEnumOleVerb</span><span class="p">);</span>
 <span class="k">void</span> <span class="nf">Update</span><span class="p">();</span>
 <span class="k">void</span> <span class="nf">IsUpToDate</span><span class="p">();</span>
 <span class="k">void</span> <span class="nf">GetUserClassID</span><span class="p">(</span><span class="kt">uint</span> <span class="n">pClsid</span><span class="p">);</span>
 <span class="k">void</span> <span class="nf">GetUserType</span><span class="p">(</span><span class="kt">uint</span> <span class="n">dwFormOfType</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">pszUserType</span><span class="p">);</span>
 <span class="k">void</span> <span class="nf">SetExtent</span><span class="p">(</span><span class="kt">uint</span> <span class="n">dwDrawAspect</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">psizel</span><span class="p">);</span>
 <span class="k">void</span> <span class="nf">GetExtent</span><span class="p">(</span><span class="kt">uint</span> <span class="n">dwDrawAspect</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">psizel</span><span class="p">);</span>
 <span class="k">void</span> <span class="nf">Advise</span><span class="p">(</span><span class="kt">object</span> <span class="n">pAdvSink</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">pdwConnection</span><span class="p">);</span>
 <span class="k">void</span> <span class="nf">Unadvise</span><span class="p">(</span><span class="kt">uint</span> <span class="n">dwConnection</span><span class="p">);</span>
 <span class="k">void</span> <span class="nf">EnumAdvise</span><span class="p">(</span><span class="k">ref</span> <span class="kt">object</span> <span class="n">ppenumAdvise</span><span class="p">);</span>
 <span class="k">void</span> <span class="nf">GetMiscStatus</span><span class="p">(</span><span class="kt">uint</span> <span class="n">dwAspect</span><span class="p">,</span><span class="kt">uint</span> <span class="n">pdwStatus</span><span class="p">);</span>
 <span class="k">void</span> <span class="nf">SetColorScheme</span><span class="p">(</span><span class="kt">object</span> <span class="n">pLogpal</span><span class="p">);</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Now, you can define the object that will host the web browser, using the interfaces you have just declared.</p>

<div class="language-csharp highlighter-rouge"><pre class="highlight"><code><span class="k">using</span> <span class="nn">System.Runtime.InteropServices</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Windows.Forms</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">mshtml</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">WebBrowser</span><span class="p">:</span>
 <span class="n">IOleClientSite</span><span class="p">,</span>    <span class="c1">// so MsHtml uses IDocHostUIHandler
</span> <span class="n">IDocHostUIHandler</span><span class="p">,</span>
 <span class="n">IOleDocumentSite</span><span class="p">,</span>  <span class="c1">// so MsHtml uses IDocHostShowUI
</span> <span class="n">IDocHostShowUI</span>
<span class="p">{</span>
 <span class="err">#</span><span class="n">region</span> <span class="n">IOleClientSite</span> <span class="n">methods</span>

 <span class="k">void</span> <span class="n">IOleClientSite</span><span class="p">.</span><span class="nf">SaveObject</span><span class="p">()</span> <span class="p">{}</span>
 <span class="k">void</span> <span class="n">IOleClientSite</span><span class="p">.</span><span class="nf">GetMoniker</span><span class="p">(</span><span class="kt">uint</span> <span class="n">dwAssign</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">dwWhichMoniker</span><span class="p">,</span> <span class="k">ref</span> <span class="kt">object</span> <span class="n">ppmk</span><span class="p">)</span> <span class="p">{}</span>
 <span class="k">void</span> <span class="n">IOleClientSite</span><span class="p">.</span><span class="nf">GetContainer</span><span class="p">(</span><span class="k">ref</span> <span class="kt">object</span> <span class="n">ppContainer</span><span class="p">)</span> <span class="p">{</span><span class="n">ppContainer</span> <span class="p">=</span> <span class="k">this</span><span class="p">;}</span>
 <span class="k">void</span> <span class="n">IOleClientSite</span><span class="p">.</span><span class="nf">ShowObject</span><span class="p">()</span> <span class="p">{}</span>
 <span class="k">void</span> <span class="n">IOleClientSite</span><span class="p">.</span><span class="nf">OnShowWindow</span><span class="p">(</span><span class="kt">bool</span> <span class="n">fShow</span><span class="p">)</span> <span class="p">{}</span>
 <span class="k">void</span> <span class="n">IOleClientSite</span><span class="p">.</span><span class="nf">RequestNewObjectLayout</span><span class="p">()</span> <span class="p">{}</span>

 <span class="err">#</span><span class="n">endregion</span>

 <span class="err">#</span><span class="n">region</span> <span class="n">IDocHostUIHandler</span> <span class="n">methods</span>

 <span class="k">public</span> <span class="kt">uint</span> <span class="nf">ShowContextMenu</span><span class="p">(</span><span class="kt">uint</span> <span class="n">dwID</span><span class="p">,</span> <span class="k">ref</span> <span class="n">tagPOINT</span> <span class="n">ppt</span><span class="p">,</span> <span class="kt">object</span> <span class="n">pcmdtReserved</span><span class="p">,</span> <span class="kt">object</span> <span class="n">pdispReserved</span><span class="p">)</span>
 <span class="p">{</span>
  <span class="c1">//const int MenuHandled = 0; // uncomment this line, and comment the next one, to show the context menu
</span>  <span class="k">const</span> <span class="kt">int</span> <span class="n">MenuNotHandled</span> <span class="p">=</span> <span class="m">1</span><span class="p">;</span>
  <span class="k">return</span> <span class="n">MenuNotHandled</span><span class="p">;</span>
 <span class="p">}</span>

 <span class="k">public</span> <span class="kt">uint</span> <span class="nf">TranslateAccelerator</span><span class="p">(</span><span class="k">ref</span> <span class="n">tagMSG</span> <span class="n">lpMsg</span><span class="p">,</span> <span class="k">ref</span> <span class="n">Guid</span> <span class="n">pguidCmdGroup</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">nCmdID</span><span class="p">)</span>
 <span class="p">{</span>
  <span class="c1">//const int KillAccelerator = 0;
</span>  <span class="k">const</span> <span class="kt">int</span> <span class="n">AllowAccelerator</span> <span class="p">=</span> <span class="m">1</span><span class="p">;</span>
  <span class="k">return</span> <span class="n">AllowAccelerator</span><span class="p">;</span>
 <span class="p">}</span>

 <span class="k">public</span> <span class="kt">object</span> <span class="nf">GetDropTarget</span><span class="p">(</span><span class="k">ref</span> <span class="kt">object</span> <span class="n">pDropTarget</span><span class="p">)</span> 
 <span class="p">{</span>
  <span class="k">return</span> <span class="n">pDropTarget</span><span class="p">;</span>
 <span class="p">}</span>

 <span class="k">public</span> <span class="kt">object</span> <span class="nf">GetExternal</span><span class="p">()</span>
 <span class="p">{</span>
  <span class="k">return</span> <span class="k">null</span><span class="p">;</span>
 <span class="p">}</span>

 <span class="k">public</span> <span class="kt">uint</span> <span class="nf">TranslateUrl</span><span class="p">(</span><span class="kt">uint</span> <span class="n">dwTranslate</span><span class="p">,</span> <span class="kt">string</span> <span class="n">URLIn</span><span class="p">,</span> <span class="k">ref</span> <span class="kt">string</span> <span class="n">URLOut</span><span class="p">)</span>
 <span class="p">{</span>
  <span class="c1">//const int Translated = 0;
</span>  <span class="k">const</span> <span class="kt">int</span> <span class="n">NotTranslated</span> <span class="p">=</span> <span class="m">1</span><span class="p">;</span>
  <span class="k">return</span> <span class="n">NotTranslated</span><span class="p">;</span>
 <span class="p">}</span>

 <span class="k">public</span> <span class="n">IDataObject</span> <span class="nf">FilterDataObject</span><span class="p">(</span><span class="n">IDataObject</span> <span class="n">pDO</span><span class="p">)</span> 
 <span class="p">{</span>
  <span class="k">return</span> <span class="k">null</span><span class="p">;</span>
 <span class="p">}</span>

 <span class="k">public</span> <span class="k">void</span> <span class="nf">GetHostInfo</span><span class="p">(</span><span class="k">ref</span> <span class="n">DOCHOSTUIINFO</span> <span class="n">theHostUIInfo</span><span class="p">)</span> <span class="p">{}</span>
 <span class="k">public</span> <span class="k">void</span> <span class="nf">ShowUI</span><span class="p">(</span><span class="kt">uint</span> <span class="n">dwID</span><span class="p">,</span> <span class="k">ref</span> <span class="kt">object</span> <span class="n">pActiveObject</span><span class="p">,</span> <span class="k">ref</span> <span class="kt">object</span> <span class="n">pCommandTarget</span><span class="p">,</span> <span class="k">ref</span> <span class="kt">object</span> <span class="n">pFrame</span><span class="p">,</span> <span class="k">ref</span> <span class="kt">object</span> <span class="n">pDoc</span><span class="p">)</span> <span class="p">{}</span>
 <span class="k">public</span> <span class="k">void</span> <span class="nf">HideUI</span><span class="p">()</span> <span class="p">{}</span>
 <span class="k">public</span> <span class="k">void</span> <span class="nf">UpdateUI</span><span class="p">()</span> <span class="p">{}</span>
 <span class="k">public</span> <span class="k">void</span> <span class="nf">EnableModeless</span><span class="p">(</span><span class="kt">int</span> <span class="n">fEnable</span><span class="p">)</span> <span class="p">{}</span>
 <span class="k">public</span> <span class="k">void</span> <span class="nf">OnDocWindowActivate</span><span class="p">(</span><span class="kt">int</span> <span class="n">fActivate</span><span class="p">)</span> <span class="p">{}</span>
 <span class="k">public</span> <span class="k">void</span> <span class="nf">OnFrameWindowActivate</span><span class="p">(</span><span class="kt">int</span> <span class="n">fActivate</span><span class="p">)</span> <span class="p">{}</span>
 <span class="k">public</span> <span class="k">void</span> <span class="nf">ResizeBorder</span><span class="p">(</span><span class="k">ref</span> <span class="n">tagRECT</span> <span class="n">prcBorder</span><span class="p">,</span> <span class="kt">int</span> <span class="n">pUIWindow</span><span class="p">,</span> <span class="kt">int</span> <span class="n">fRameWindow</span><span class="p">)</span> <span class="p">{}</span>
 <span class="k">public</span> <span class="k">void</span> <span class="nf">GetOptionKeyPath</span><span class="p">(</span><span class="k">ref</span> <span class="kt">string</span> <span class="n">pchKey</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">dw</span><span class="p">)</span> <span class="p">{}</span>

 <span class="err">#</span><span class="n">endregion</span>

 <span class="err">#</span><span class="n">region</span> <span class="n">IOleDocumentSite</span> <span class="n">methods</span>

 <span class="k">public</span> <span class="k">void</span> <span class="nf">ActivateMe</span><span class="p">(</span><span class="k">ref</span> <span class="kt">object</span> <span class="n">pViewToActivate</span><span class="p">)</span> <span class="p">{}</span>

 <span class="err">#</span><span class="n">endregion</span>

 <span class="err">#</span><span class="n">region</span> <span class="n">IDocHostShowUI</span> <span class="n">methods</span>

 <span class="k">public</span> <span class="kt">uint</span> <span class="nf">ShowMessage</span><span class="p">(</span><span class="n">IntPtr</span> <span class="n">hwnd</span><span class="p">,</span> <span class="kt">string</span> <span class="n">msgText</span><span class="p">,</span> <span class="kt">string</span> <span class="n">msgCaption</span><span class="p">,</span>
  <span class="kt">uint</span> <span class="n">dwType</span><span class="p">,</span> <span class="kt">string</span> <span class="n">lpstrHelpFile</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">dwHelpContext</span><span class="p">,</span>
  <span class="k">out</span> <span class="kt">int</span> <span class="n">lpResult</span><span class="p">)</span>
 <span class="p">{</span>
  <span class="c1">// msgText is the contents of the MessageBox
</span>  <span class="c1">// msgCaption is the text on the MessageBox caption bar
</span>
  <span class="c1">// this is where you can deal with javascript popup boxes and simulate clicking different buttons
</span>  <span class="n">lpResult</span> <span class="p">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="n">DialogBoxCommandId</span><span class="p">.</span><span class="n">Ok</span><span class="p">;</span>

  <span class="c1">// return one of these values
</span>  <span class="k">const</span> <span class="kt">int</span> <span class="n">MessageHandled</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>    <span class="c1">// MsHtml won't display its MessageBox
</span>  <span class="c1">//const int MessageNotHandled = 1; // MsHtml will display its MessageBox
</span>  <span class="k">return</span> <span class="n">MessageHandled</span><span class="p">;</span>
 <span class="p">}</span>
                                  
 <span class="k">public</span> <span class="kt">uint</span> <span class="nf">ShowHelp</span><span class="p">(</span><span class="n">IntPtr</span> <span class="n">hwnd</span><span class="p">,</span> <span class="kt">string</span> <span class="n">pszHelpFile</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">uCommand</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">dwData</span><span class="p">,</span> 
  <span class="n">tagPOINT</span> <span class="n">ptMouse</span><span class="p">,</span> <span class="kt">object</span> <span class="n">pDispatchObjectHit</span><span class="p">)</span>
 <span class="p">{</span>
  <span class="c1">// pDispatchObject will reference an object of
</span>  <span class="c1">// type mshtml.HTMLDocumentClass, or other class
</span>  <span class="c1">// representing something on the HTML page.
</span>      
  <span class="c1">// return one of these values
</span>  <span class="c1">//const int HelpHandled = 0;    // MsHtml won't display its Help window
</span>  <span class="k">const</span> <span class="kt">int</span> <span class="n">HelpNotHandled</span> <span class="p">=</span> <span class="m">1</span><span class="p">;</span> <span class="c1">// MsHtml will display its Help window
</span>
  <span class="k">return</span> <span class="n">HelpNotHandled</span><span class="p">;</span>
 <span class="p">}</span>
                      
 <span class="err">#</span><span class="n">endregion</span>

 <span class="err">#</span><span class="n">region</span> <span class="n">IDispatch</span> <span class="n">methods</span>

 <span class="p">[</span><span class="nf">DispId</span><span class="p">(-</span><span class="m">5512</span><span class="p">)]</span> <span class="c1">// DISPID_AMBIENT_DLCONTROL = -5512
</span> <span class="k">public</span> <span class="kt">int</span> <span class="nf">IDispatch_Invoke_Handler</span><span class="p">()</span>
 <span class="p">{</span>
  <span class="c1">// I have found that DLCTL_NO_CLIENTPULL means that things like meta refreshes are not executed
</span>  <span class="kt">int</span> <span class="n">lReturn</span> <span class="p">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="p">(</span><span class="n">ComConstants</span><span class="p">.</span><span class="n">DLCTL_PRAGMA_NO_CACHE</span> <span class="p">|</span> <span class="n">ComConstants</span><span class="p">.</span><span class="n">DLCTL_SILENT</span> <span class="p">|</span> <span class="n">ComConstants</span><span class="p">.</span><span class="n">DLCTL_NO_BEHAVIORS</span> <span class="p">|</span> <span class="n">ComConstants</span><span class="p">.</span><span class="n">DLCTL_NO_JAVA</span> <span class="p">|</span> <span class="n">ComConstants</span><span class="p">.</span><span class="n">DLCTL_NO_FRAMEDOWNLOAD</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(!</span><span class="n">Configuration</span><span class="p">.</span><span class="n">LoadActiveXControls</span><span class="p">)</span>
  <span class="p">{</span>
   <span class="n">lReturn</span> <span class="p">|=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="p">(</span><span class="n">ComConstants</span><span class="p">.</span><span class="n">DLCTL_NO_DLACTIVEXCTLS</span> <span class="p">|</span> <span class="n">ComConstants</span><span class="p">.</span><span class="n">DLCTL_NO_RUNACTIVEXCTLS</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">Configuration</span><span class="p">.</span><span class="n">LoadImages</span><span class="p">)</span>
  <span class="p">{</span>
   <span class="n">lReturn</span> <span class="p">|=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="n">ComConstants</span><span class="p">.</span><span class="n">DLCTL_DLIMAGES</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">lReturn</span><span class="p">;</span>
 <span class="p">}</span>

 <span class="err">#</span><span class="n">endregion</span>
<span class="p">}</span>
</code></pre>
</div>

<p>In my code, I have a member variable mWebBrowser, of type AxWebBrowser, inside my WebBrowser class. After I’ve created it, the following lines are necessary to “register” the WebBrowser class as the host:</p>

<div class="language-csharp highlighter-rouge"><pre class="highlight"><code><span class="n">IOleObject</span> <span class="n">lOleObject</span> <span class="p">=</span> <span class="p">(</span><span class="n">IOleObject</span><span class="p">)</span> <span class="n">mWebBrowser</span><span class="p">.</span><span class="nf">GetOcx</span><span class="p">();</span>
<span class="n">lOleObject</span><span class="p">.</span><span class="nf">SetClientSite</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
</code></pre>
</div>

</article>

<nav class="pagination">
  
    <a class="pagination-item" href="/blog/archive/2006/08/14/ilyrics">Previous</a>
  
  
    <a class="pagination-item" href="/blog/archive/2006/08/19/the-size-of-space">Next</a>
  
</nav>

<div id="disqus_thread"></div>
<script>
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://timjones.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        </main>
    </div>

    <footer class="site-footer">
        <div class="container">
            <div class="social">
    <ul>
        <li>
            <a href="https://twitter.com/_tim_jones_" rel="external">
                <svg width="30" height="30" viewBox="0 0 30 32" xmlns="http://www.w3.org/2000/svg" aria-labelledby="title">
  <title id="title">Twitter icon</title>
  <desc>A gray icon for following me on Twitter</desc>
  <path d="M28.928 7.296q-1.184 1.728-2.88 2.976 0 0.256 0 0.736 0 2.336-0.672 4.64t-2.048 4.448-3.296 3.744-4.608 2.624-5.792 0.96q-4.832 0-8.832-2.592 0.608 0.064 1.376 0.064 4.032 0 7.168-2.464-1.888-0.032-3.36-1.152t-2.048-2.848q0.608 0.096 1.088 0.096 0.768 0 1.536-0.192-2.016-0.416-3.328-1.984t-1.312-3.68v-0.064q1.216 0.672 2.624 0.736-1.184-0.8-1.888-2.048t-0.704-2.752q0-1.568 0.8-2.912 2.176 2.656 5.248 4.256t6.656 1.76q-0.16-0.672-0.16-1.312 0-2.4 1.696-4.064t4.064-1.696q2.528 0 4.224 1.824 1.952-0.384 3.68-1.408-0.672 2.048-2.56 3.2 1.664-0.192 3.328-0.896z"></path>
</svg>
                <span>Follow me on Twitter</span>
            </a>
        </li>
        <li>
            <a href="https://github.com/tgjones" rel="external">
                <svg width="30" height="30" viewBox="0 0 27 32" xmlns="http://www.w3.org/2000/svg" aria-labelledby="title">
  <title id="title">GitHub icon</title>
  <desc>A gray icon for following me on GitHub</desc>
  <path d="M13.728 2.272q3.712 0 6.88 1.856t4.992 4.992 1.824 6.88q0 4.48-2.624 8.064t-6.752 4.96q-0.48 0.096-0.704-0.128t-0.224-0.544q0-0.032 0-1.376t0-2.4q0-1.728-0.928-2.528 1.024-0.096 1.824-0.32t1.696-0.704 1.44-1.184 0.96-1.856 0.352-2.688q0-2.144-1.408-3.68 0.672-1.632-0.128-3.648-0.512-0.16-1.472 0.192t-1.632 0.8l-0.672 0.416q-1.664-0.48-3.424-0.48t-3.456 0.48q-0.256-0.192-0.736-0.48t-1.504-0.704-1.504-0.224q-0.8 2.016-0.16 3.648-1.408 1.536-1.408 3.68 0 1.504 0.384 2.656t0.928 1.888 1.44 1.184 1.664 0.704 1.824 0.32q-0.672 0.64-0.864 1.856-0.384 0.16-0.8 0.256t-1.024 0.096-1.152-0.384-0.992-1.12q-0.352-0.576-0.864-0.928t-0.896-0.448l-0.352-0.032q-0.384 0-0.512 0.064t-0.096 0.224 0.16 0.256 0.224 0.192l0.128 0.096q0.384 0.192 0.768 0.672t0.576 0.928l0.192 0.416q0.224 0.672 0.768 1.088t1.184 0.544 1.248 0.096 0.992-0.032l0.416-0.096q0 0.704 0 1.6t0.032 0.96q0 0.32-0.256 0.544t-0.704 0.128q-4.128-1.376-6.752-4.96t-2.624-8.064q0-3.744 1.856-6.88t4.96-4.992 6.912-1.856zM5.184 21.984q0.064-0.128-0.096-0.224-0.192-0.032-0.256 0.032-0.032 0.128 0.128 0.224t0.224-0.032zM5.76 22.592q0.128-0.096-0.032-0.288-0.192-0.16-0.288-0.064-0.128 0.096 0.032 0.288t0.288 0.064zM6.272 23.392q0.192-0.128 0-0.352-0.128-0.224-0.288-0.096-0.16 0.096 0 0.32t0.288 0.128zM7.040 24.128q0.128-0.128-0.064-0.32-0.224-0.224-0.352-0.064-0.16 0.16 0.064 0.352 0.192 0.192 0.352 0.032zM8.064 24.576q0.032-0.192-0.256-0.288-0.256-0.064-0.32 0.128t0.224 0.288q0.256 0.096 0.352-0.128zM9.184 24.672q0-0.224-0.32-0.192-0.288 0-0.288 0.192 0 0.224 0.32 0.192 0.288 0 0.288-0.192zM10.208 24.512q-0.032-0.224-0.32-0.16-0.288 0.032-0.256 0.256t0.32 0.128 0.256-0.224z"></path>
</svg>        
                <span>Follow me on GitHub</span>
            </a>
        </li>
        <li>
            <a href="https://www.strava.com/athletes/timjones" rel="external">
                <?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 width="30px" height="30px" viewBox="0 0 244 244" enable-background="new 0 0 244 244" xml:space="preserve">
<g>
	<path fill="none" d="M122,242C55.8,242,2,188.2,2,122S55.8,2,122,2c66.2,0,120,53.8,120,120S188.2,242,122,242z M122,21.7
		c-55.3,0-100.3,45-100.3,100.3s45,100.3,100.3,100.3s100.3-45,100.3-100.3S177.3,21.7,122,21.7z"/>
	<path d="M122,21.7c-55.3,0-100.3,45-100.3,100.3s45,100.3,100.3,100.3s100.3-45,100.3-100.3S177.3,21.7,122,21.7z"
		/>
	<g>
		<polyline fill="#fff" points="139.4,184.3 112.3,131.1 128.4,131.1 139.4,152.6 150.2,131.1 166.3,131.1 139.4,184.3 		"/>
		<polygon fill="#fff" points="113.9,102.2 128.6,131.2 150.1,131.2 113.7,59.7 77.7,131.2 99.3,131.2 113.9,102.2 		"/>
	</g>
</g>
</svg>

                <span>Follow me on Strava</span>
            </a>
        </li>
    </ul>
</div>

            <p>© 2017 Tim Jones. All rights reserved.</p>
        </div>
    </footer>

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-5166698-5', 'auto');
  ga('send', 'pageview');
</script>
</body>

</html>