<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">

    <title>OpenSAGE Dev Diary #6 (2018-02-10) - and 1st release! - timjones.io</title>

    <meta name="description" content="Blog and open source projects by Tim Jones.">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="alternate" href="http://timjones.io/feed.xml" type="application/atom+xml" title="timjones.io Feed">

    <link href="https://fonts.googleapis.com/css?family=Noto+Sans|Noto+Serif|Source+Code+Pro" rel="stylesheet">
    <link rel="stylesheet" href="/assets/css/site.css">

    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [['$','$'], ['\\(','\\)']],
                processEscapes: true
            },
            showProcessingMessages: false
        });
    </script>
    <script type="text/javascript" async src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML.js"></script>
</head>

<body>
    <header class="masthead">
        <div class="container">
            <nav>
                <ul>
                    <li>
                        <h3><a href="/" class="site-title">Tim Jones</a></h3>
                    </li>
                    <li><a href="/projects/">Projects</a></li>
                    <li><a href="/about/">About</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <div class="container">
        <main>
            <article>
    <h1 class="post-title">OpenSAGE Dev Diary #6 (2018-02-10) - and 1st release!</h1>

    <div class="post-date">
        <time datetime="2018-02-10T10:00:00+00:00">10 February 2018</time>
    </div>

    
    <div class="post-tags">
        <ul>
            
            <li><a href="/blog/tags/opensage">OpenSAGE</a></li>
            
        </ul>
    </div>
    

    <p><em>OpenSAGE is an open-source re-implementation of the <a href="https://en.wikipedia.org/wiki/SAGE_(game_engine)">SAGE game engine</a>. It is not affiliated with EA in any way. SAGE was the game engine used in C&amp;C Generals, C&amp;C Generals Zero Hour, Battle for Middle-earth and its sequels, C&amp;C 3 and its sequel, and Red Alert 3 and its sequel. I’ve been working on OpenSAGE for 6 months, and made some good progress, so I’ve started this series of blog posts to talk about what is happening in the project each week. You can also star or watch the <a href="https://github.com/OpenSAGE/OpenSAGE">OpenSAGE GitHub repo</a> for a more real-time view of things.</em></p>

<h2 id="an-anniversary">An anniversary</h2>

<p>15 years ago today - on February 10th, 2003 - one of my favourite games, <a href="https://en.wikipedia.org/wiki/Command_%26_Conquer:_Generals">Command &amp; Conquer: Generals</a>, was released. I was at university at the time. I don’t remember if I bought it on launch day, or a few days after, but I do remember being excited to bring the game
home from the shop (because that was a thing we did in those days) and play it. I’d been a big fan of the Westwood era of C&amp;C games, but the screenshots on the back
of this box looked like something different and exciting.</p>

<p>Long story short, I ploughed a vast number of hours into C&amp;C Generals, and its sequel released later that year, Zero Hour. I was never a particularly good player,
but that didn’t matter to me. I remember epic LAN games with two of my then-housemates, where the tide of war would ebb and flow to the accompaniment of commentary shouted between rooms.</p>

<p>So today, 15 years later, seems like an appropriate day for the first OpenSAGE release.</p>

<h2 id="release-20180210">Release 20180210</h2>

<p>The very first release of OpenSAGE - catchily named 20180210 - is now available for download. <a href="https://github.com/OpenSAGE/OpenSAGE/releases/tag/release-20180210">Grab it here</a>!</p>

<div class="video-responsive">
    <iframe width="560" height="315" src="https://www.youtube.com/embed/pFLK_DQXzp0" frameborder="0" gesture="media" allow="encrypted-media" allowfullscreen=""></iframe>
</div>

<p>First, some caveats. This is a <em>very</em> early preview, representing the current state of the OpenSAGE project. It is nowhere near playable. There are number of lower-level elements in place - model rendering, map rendering, some menus - and these work quite well already. But we haven’t yet started on gameplay.</p>

<p>This first release contains two separate applications: a “Data Viewer” and a “Launcher”. The launcher is shown in the video above. The video shows basically everything that the launcher can currently do - which, if you look carefully, is actually quite a lot. It can load and render the shell map, load and render 3D models on the map, load and render the main menu, and handle transitions between menus.</p>

<p>The Data Viewer can preview files (including 3D models, maps, .ini files, and more) from any SAGE-based games that you have on your computer. We are using it as a development tool, but it may well be of interest to modders and anybody curious about how RTS games are built.</p>

<p><img src="/assets/resized/opensage-2018-02-10-map-viewer-1600x947.png" alt="Data Viewer" srcset="/assets/resized/opensage-2018-02-10-map-viewer-400x237.png 400w,/assets/resized/opensage-2018-02-10-map-viewer-800x473.png 800w,/assets/resized/opensage-2018-02-10-map-viewer-1200x710.png 1200w,/assets/resized/opensage-2018-02-10-map-viewer-1600x947.png 1600w" /></p>

<p>It’s probably not worth logging issues on GitHub yet, because it’s so early in development. Nothing works, except for the stuff that does. But if you’re pretty sure that you’ve found a bug in something that <em>should</em> work, then feel free to <a href="https://github.com/OpenSAGE/OpenSAGE/issues">log an issue</a>.</p>

<h2 id="progress-since-the-last-dev-diary">Progress since the last dev diary</h2>

<p>A huge amount has happened to OpenSAGE since the <a href="/blog/archive/2018/01/07/opensage-dev-diary-5">the previous dev diary</a>:</p>

<ul>
  <li>I implemented cloud shadows and macrotextures in the terrain renderer. These are quite subtle effects, but obvious when they’re removed. Unlike the original Generals game, OpenSAGE’s cloud shadows apply to objects too!</li>
</ul>

<div class="video-responsive">
    <iframe width="560" height="315" src="https://www.youtube.com/embed/_QM3T_zU66E" frameborder="0" gesture="media" allow="encrypted-media" allowfullscreen=""></iframe>
</div>

<ul>
  <li><a href="https://github.com/feliwir">Stephan</a> did a lot of great work on the ActionScript interpreter that lies at the heart of the APT runtime. APT is the GUI framework used in BFME and later games. The main menu from BFME II now loads and partially runs, although there’s plenty left to do:</li>
</ul>

<div class="video-responsive">
    <iframe width="560" height="315" src="https://www.youtube.com/embed/Lo1iqrUP6GQ" frameborder="0" gesture="media" allow="encrypted-media" allowfullscreen=""></iframe>
</div>

<ul>
  <li><a href="https://github.com/paavohuhtala">Paavo</a> snuck in an Export feature to the Data Viewer at the last minute:</li>
</ul>

<p><img src="/assets/resized/opensage-2018-02-10-data-viewer-export-400x327.png" alt="Data Viewer export" srcset="/assets/resized/opensage-2018-02-10-data-viewer-export-400x327.png 400w" /></p>

<p>We’ve also made many lower-level changes:</p>

<ul>
  <li>Moved from a custom rendering backend to <a href="https://github.com/mellinoe/veldrid">Veldrid</a>. This will allow us to make OpenSAGE cross-platform.</li>
  <li>Moved windowing to SDL2 - also with the aim of making OpenSAGE cross-platform.</li>
  <li>Fixed some memory leaks in the Data Viewer.</li>
  <li>Refactored the scene structure to make more sense.</li>
  <li>Paavo implemented object collision. This can be seen when viewing a map in the Data Viewer - if you click on an object, it will shrink, which is an amusing but obviously temporary way to test the collision system.</li>
  <li>Paavo optimised particle systems, such that they don’t allocate any memory on the heap in their per-frame update.</li>
  <li>Paavo created separate C# projects for each SAGE game. This will help us keep game-specific code out of the core engine.</li>
  <li>Paavo rewrote the map scripting system, and implemented many more script actions and conditions.</li>
  <li>Paavo implemented more .wnd callbacks, which means more of the main menu works.</li>
  <li>Added initial support for the .manifest / .relo / .imp / .bin file system used in C&amp;C3 and above.</li>
  <li>Parsed the .map format for C&amp;C3, RA3, and C&amp;C4.</li>
</ul>

<h2 id="onwards">Onwards…</h2>

<p>I hope you’ll <a href="https://github.com/OpenSAGE/OpenSAGE/releases/tag/release-20180210">give OpenSAGE a try</a> - if you do, please let me know your thoughts and feedback in the comments below.</p>

</article>

<nav class="pagination">
  
    <a class="pagination-item" href="/blog/archive/2018/01/07/opensage-dev-diary-5">Previous</a>
  
  
    <a class="pagination-item" href="/blog/archive/2018/03/06/parsing-command-and-conquer-generals-replay-files">Next</a>
  
</nav>

<div id="disqus_thread"></div>
<script>
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://timjones.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        </main>
    </div>

    <footer class="site-footer">
        <div class="container">
            <div class="social">
    <ul>
        <li>
            <a href="https://twitter.com/_tim_jones_" rel="external">
                <svg width="30" height="30" viewBox="0 0 30 32" xmlns="http://www.w3.org/2000/svg" aria-labelledby="title">
  <title id="title">Twitter icon</title>
  <desc>A gray icon for following me on Twitter</desc>
  <path d="M28.928 7.296q-1.184 1.728-2.88 2.976 0 0.256 0 0.736 0 2.336-0.672 4.64t-2.048 4.448-3.296 3.744-4.608 2.624-5.792 0.96q-4.832 0-8.832-2.592 0.608 0.064 1.376 0.064 4.032 0 7.168-2.464-1.888-0.032-3.36-1.152t-2.048-2.848q0.608 0.096 1.088 0.096 0.768 0 1.536-0.192-2.016-0.416-3.328-1.984t-1.312-3.68v-0.064q1.216 0.672 2.624 0.736-1.184-0.8-1.888-2.048t-0.704-2.752q0-1.568 0.8-2.912 2.176 2.656 5.248 4.256t6.656 1.76q-0.16-0.672-0.16-1.312 0-2.4 1.696-4.064t4.064-1.696q2.528 0 4.224 1.824 1.952-0.384 3.68-1.408-0.672 2.048-2.56 3.2 1.664-0.192 3.328-0.896z"></path>
</svg>
                <span>Follow me on Twitter</span>
            </a>
        </li>
        <li>
            <a href="https://github.com/tgjones" rel="external">
                <svg width="30" height="30" viewBox="0 0 27 32" xmlns="http://www.w3.org/2000/svg" aria-labelledby="title">
  <title id="title">GitHub icon</title>
  <desc>A gray icon for following me on GitHub</desc>
  <path d="M13.728 2.272q3.712 0 6.88 1.856t4.992 4.992 1.824 6.88q0 4.48-2.624 8.064t-6.752 4.96q-0.48 0.096-0.704-0.128t-0.224-0.544q0-0.032 0-1.376t0-2.4q0-1.728-0.928-2.528 1.024-0.096 1.824-0.32t1.696-0.704 1.44-1.184 0.96-1.856 0.352-2.688q0-2.144-1.408-3.68 0.672-1.632-0.128-3.648-0.512-0.16-1.472 0.192t-1.632 0.8l-0.672 0.416q-1.664-0.48-3.424-0.48t-3.456 0.48q-0.256-0.192-0.736-0.48t-1.504-0.704-1.504-0.224q-0.8 2.016-0.16 3.648-1.408 1.536-1.408 3.68 0 1.504 0.384 2.656t0.928 1.888 1.44 1.184 1.664 0.704 1.824 0.32q-0.672 0.64-0.864 1.856-0.384 0.16-0.8 0.256t-1.024 0.096-1.152-0.384-0.992-1.12q-0.352-0.576-0.864-0.928t-0.896-0.448l-0.352-0.032q-0.384 0-0.512 0.064t-0.096 0.224 0.16 0.256 0.224 0.192l0.128 0.096q0.384 0.192 0.768 0.672t0.576 0.928l0.192 0.416q0.224 0.672 0.768 1.088t1.184 0.544 1.248 0.096 0.992-0.032l0.416-0.096q0 0.704 0 1.6t0.032 0.96q0 0.32-0.256 0.544t-0.704 0.128q-4.128-1.376-6.752-4.96t-2.624-8.064q0-3.744 1.856-6.88t4.96-4.992 6.912-1.856zM5.184 21.984q0.064-0.128-0.096-0.224-0.192-0.032-0.256 0.032-0.032 0.128 0.128 0.224t0.224-0.032zM5.76 22.592q0.128-0.096-0.032-0.288-0.192-0.16-0.288-0.064-0.128 0.096 0.032 0.288t0.288 0.064zM6.272 23.392q0.192-0.128 0-0.352-0.128-0.224-0.288-0.096-0.16 0.096 0 0.32t0.288 0.128zM7.040 24.128q0.128-0.128-0.064-0.32-0.224-0.224-0.352-0.064-0.16 0.16 0.064 0.352 0.192 0.192 0.352 0.032zM8.064 24.576q0.032-0.192-0.256-0.288-0.256-0.064-0.32 0.128t0.224 0.288q0.256 0.096 0.352-0.128zM9.184 24.672q0-0.224-0.32-0.192-0.288 0-0.288 0.192 0 0.224 0.32 0.192 0.288 0 0.288-0.192zM10.208 24.512q-0.032-0.224-0.32-0.16-0.288 0.032-0.256 0.256t0.32 0.128 0.256-0.224z"></path>
</svg>        
                <span>Follow me on GitHub</span>
            </a>
        </li>
        <li>
            <a href="https://www.strava.com/athletes/timjones" rel="external">
                <?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 width="30px" height="30px" viewBox="0 0 244 244" enable-background="new 0 0 244 244" xml:space="preserve">
<g>
	<path fill="none" d="M122,242C55.8,242,2,188.2,2,122S55.8,2,122,2c66.2,0,120,53.8,120,120S188.2,242,122,242z M122,21.7
		c-55.3,0-100.3,45-100.3,100.3s45,100.3,100.3,100.3s100.3-45,100.3-100.3S177.3,21.7,122,21.7z"/>
	<path d="M122,21.7c-55.3,0-100.3,45-100.3,100.3s45,100.3,100.3,100.3s100.3-45,100.3-100.3S177.3,21.7,122,21.7z"
		/>
	<g>
		<polyline fill="#fff" points="139.4,184.3 112.3,131.1 128.4,131.1 139.4,152.6 150.2,131.1 166.3,131.1 139.4,184.3 		"/>
		<polygon fill="#fff" points="113.9,102.2 128.6,131.2 150.1,131.2 113.7,59.7 77.7,131.2 99.3,131.2 113.9,102.2 		"/>
	</g>
</g>
</svg>

                <span>Follow me on Strava</span>
            </a>
        </li>
    </ul>
</div>

            <p>© 2017 Tim Jones. All rights reserved.</p>
        </div>
    </footer>

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-5166698-5', 'auto');
  ga('send', 'pageview');
</script>
</body>

</html>